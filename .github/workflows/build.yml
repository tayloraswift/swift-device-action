on:
    workflow_call:
        inputs:
            xcode-scheme:
                description: 'The Xcode scheme to build'
                required: true
                type: string

            xcode-version:
                description: 'The Xcode version to use'
                required: false
                type: string
                default: 'Xcode_16.4'

            destination:
                description: 'The destination platform'
                required: true
                type: string

jobs:
    build:
        runs-on: macos-15
        name: macOS
        steps:
            -   name: Checkout repository
                uses: actions/checkout@v4

            -   name: Select Xcode
                run: sudo xcode-select -s /Applications/${{ inputs.xcode-version }}.app/Contents/Developer

            -   name: Build
                run: |
                    swift --version
                    xcrun xcodebuild build -list
                    xcrun xcodebuild build \
                        -scheme "${{ inputs.xcode-scheme }}" \
                        -destination "generic/platform=${{ inputs.destination }}"
